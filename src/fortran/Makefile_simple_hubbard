# Makefile for Simple Honeycomb Hubbard Model
# 
# This provides a much simpler build system compared to the original complex codebase

FC = gfortran
FFLAGS = -O2 -Wall -std=f2008 -fimplicit-none
LIBS = -llapack -lblas

# Source files
MODULES = hubbard_utils.f90
PROGRAM = simple_hubbard.f90

# Object files
MOD_OBJS = $(MODULES:.f90=.o)
PROG_OBJ = $(PROGRAM:.f90=.o)

# Target executable
TARGET = simple_hubbard

.PHONY: all clean run

all: $(TARGET)

# Build executable
$(TARGET): $(MOD_OBJS) $(PROG_OBJ)
	$(FC) $(FFLAGS) -o $@ $^ $(LIBS)

# Compile modules first
%.o: %.f90
	$(FC) $(FFLAGS) -c $<

# Dependencies
$(PROG_OBJ): $(MOD_OBJS)

# Run the program
run: $(TARGET)
	./$(TARGET)

# Clean build files
clean:
	rm -f *.o *.mod $(TARGET)

# Help
help:
	@echo "Available targets:"
	@echo "  all     - Build the program"
	@echo "  run     - Build and run the program"  
	@echo "  clean   - Remove build files"
	@echo "  help    - Show this message"
	@echo ""
	@echo "Dependencies: gfortran, LAPACK, BLAS"
	@echo "Ubuntu/Debian: sudo apt install gfortran liblapack-dev libblas-dev"
	@echo "macOS: brew install gcc lapack"